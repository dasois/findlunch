# language setting
language: node_js

# version numbers, spec against multiple versions of node
node_js:
  - 6.10.3

services:
  - selenium

branches:
  only:
    - ftr_testing

before_install:
    - cd '/root/src/github.com/fr4gstar/findlunch/ionicApp'
    - sudo npm install -g protractor
    - sudo npm install webdriver-manager -g

build:
  pre_ci_boot:
    image_name: drydock/u14nodpls
    image_tag: prod
    pull: true
  ci:
    - npm install
    - mkdir -p shippable/testresults
#    - mkdir -p shippable/codecoverage
    - export DISPLAY=:99.0
    - xvfb-run --server-args="-ac" npm run e2e
#    - mysql -e 'create database if not exists test;'

after_success:
  - mkdir -p shippable/testresults
#  - mkdir -p shippable/codecoverage
#  - mocha -R xunit >> coverage/result.xml
#  - mv coverage/cobertura-coverage.xml shippable/codecoverage/coverage.xml
#  - mv coverage/result.xml shippable/testresults/result.xml
