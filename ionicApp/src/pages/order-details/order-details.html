<ion-header>
    <ion-navbar color="dark">
        <button ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title>Warenkorb</ion-title>
    </ion-navbar>
</ion-header>

<ion-content>
    <h2 padding-left>Ihr Warenkorb für {{restaurant.name}}</h2>


  <ion-grid id="orderDetails">
    <ion-row id="überschrift">
      <ion-col col-7>Bezeichnung</ion-col>
      <ion-col col-3>Menge</ion-col>
      <ion-col col-2>Preis</ion-col>
    </ion-row>
    <ion-row id="gericht" *ngFor="let item of reservation.items">
      <ion-col col-7>{{item.title}}</ion-col>
      <ion-col col-3>
        <span item-right>
        <ion-icon name="ios-remove-circle-outline" (click)="decreaseAmount(item)"></ion-icon>
              {{item.amount}}
        <ion-icon name="ios-add-circle-outline" (click)="incrAmount(item)"></ion-icon>
        </span>
      </ion-col>
      <ion-col col-2>{{item.price * item.amount | currency:'EUR':true}}</ion-col>
    </ion-row>
    <ion-row id="spende">
      <ion-col col-7 color="primary" text-wrap>
        <span item-left color="primary">
          Freiwillige Spende <ion-icon class="info-icon" name="ios-information-circle-outline" (click)="showDonationInfo()"></ion-icon>
        </span>
      </ion-col>
      <ion-col col-5 text-wrap>
        <ion-icon name="ios-remove-circle-outline" (click)="decrementDonation()"></ion-icon>
        <span item-right color="primary">{{this.reservation.donation.toFixed(2) | currency:'EUR':true}}</span>
        <ion-icon name="ios-add-circle-outline" (click)="incrementDonation()"></ion-icon>
      </ion-col>
    </ion-row>
    <ion-row id="gesamt">
      <ion-col col-7 color="primary">
        Gesamtpreis
      </ion-col>
      <ion-col col-2>
      </ion-col>
      <ion-col col-3 color="primary">
        {{reservation.totalPrice.toFixed(2) | currency:'EUR':true}}
      </ion-col>
    </ion-row>
    <ion-row id="mehrwertsteuer">
      <ion-col col-6>
        inkl. 19%MwSt
      </ion-col>
      <ion-col col-4>
      </ion-col>
      <ion-col col-2>
        {{(reservation.totalPrice/1.19*0.19).toFixed(2) | currency:'EUR':true}}
      </ion-col>

    </ion-row>
  </ion-grid>



    <ion-item *ngIf="this.auth.getLoggedIn()">
        <ion-label>Mit Treuepunkten bezahlen</ion-label>
        <ion-toggle checked="false" [(ngModel)]="this.payWithPoints" disabled="{{!this.morePointsThanNeeded}}"></ion-toggle>
    </ion-item>
    <div *ngIf="this.auth.getLoggedIn()">Sie haben bei {{restaurant.name}} derzeit {{this.userPoints}} Punkte. Um diese Bestellung mit Treuepunkten zu
        bezahlen
        benötigen Sie {{this.neededPoints}} Punkte
    </div>
    <ion-item *ngIf="this.nowOpen">
        <ion-label >Abholen um (Wunschzeit)</ion-label>
        <ion-datetime id="pickUpTime" displayFormat ="HH:mm"  min={{this.openingTime}} max={{this.closingTime}} (click)="enterPickUpTime()" [(ngModel)]="this.pickUpTimeISOFormat"></ion-datetime>
        <span item-right>Uhr</span>
    </ion-item>
    <ion-item *ngIf="!this.nowOpen" text-wrap>
        Das ausgewählte Restaurant hat leider gerade geschlossen.
    </ion-item>
    <ion-item *ngIf="!this.auth.getLoggedIn()" text-wrap>
        Sie müssen eingeloggt sein um eine Bestellung abzusenden!
    </ion-item>


    <button id="bestellen" *ngIf="this.auth.getLoggedIn()" ion-button (click)="sendOrder()">Bestellen</button>
    <div id="notLoggedIn" *ngIf="!this.auth.getLoggedIn()">
        <button  ion-button full (click)="goToLogin()">Login</button>
        <button  ion-button full (click)="goToRegister()">Registrieren</button>
    </div>

</ion-content>
